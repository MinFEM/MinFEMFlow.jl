<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · MinFEMFlow.jl</title><meta name="title" content="Examples · MinFEMFlow.jl"/><meta property="og:title" content="Examples · MinFEMFlow.jl"/><meta property="twitter:title" content="Examples · MinFEMFlow.jl"/><meta name="description" content="Documentation for MinFEMFlow.jl."/><meta property="og:description" content="Documentation for MinFEMFlow.jl."/><meta property="twitter:description" content="Documentation for MinFEMFlow.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MinFEMFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Problem-Setting"><span>Problem Setting</span></a></li><li><a class="tocitem" href="#2D-Computations"><span>2D Computations</span></a></li><li><a class="tocitem" href="#3D-Computations"><span>3D Computations</span></a></li></ul></li><li><a class="tocitem" href="../library/">Library</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><ul><li><a href="#Examples">Examples</a></li><li class="no-marker"><ul><li><a href="#Problem-Setting">Problem Setting</a></li><li><a href="#2D-Computations">2D Computations</a></li><li class="no-marker"><ul><li><a href="#Channel">Channel</a></li><li><a href="#Cylindrical-Obstacle">Cylindrical Obstacle</a></li><li><a href="#L-Channel">L Channel</a></li><li><a href="#U-Channel">U Channel</a></li><li><a href="#Y-Channel">Y Channel</a></li><li><a href="#Channel-2">∞ Channel</a></li></ul></li><li><a href="#3D-Computations">3D Computations</a></li><li class="no-marker"><ul><li><a href="#Channel-3">Channel</a></li><li><a href="#Cubical-Obstacle">Cubical Obstacle</a></li></ul></li></ul></li></ul><h2 id="Problem-Setting"><a class="docs-heading-anchor" href="#Problem-Setting">Problem Setting</a><a id="Problem-Setting-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Setting" title="Permalink"></a></h2><p><img src="../assets/examples/channel-sketch.png" alt="Channel Domain Sketch"/> <em>Sketch of a computational domain.</em></p><p>Within this package we consider problems for the Stokes equation with no-slip wall conditions, a prescribed inlet velocity and do-nothing outlet(s). For a generic domain as sketched above, we can (assuming enough regularity) mathematically write the strong for of the problem as</p><p class="math-container">\[\begin{array}{rl}
    -\Delta v + \nabla p = 0  &amp; \text{in } \Omega,\\
    \nabla \cdot v = 0  &amp; \text{in } \Omega,\\
    v = v_{\infty}  &amp; \text{on } \Gamma_{\text{in}},\\
    v = 0 &amp; \text{on } \Gamma_{\text{wall}} \cup \Gamma_{\text{obs}}.
\end{array}\]</p><p>In the setting of finite elements, we would like to consider weak solutions to the problem, which reads</p><p class="math-container">\[\begin{aligned}
    \int_\Omega \nabla v \cdot \nabla \phi \mathrm{ d}x - \int_\Omega p(\nabla \cdot \phi) \mathrm{ d}x = 0 
        &amp;\qquad\forall \phi \in \mathbb{V},\\
    \int_\Omega (\nabla \cdot v) \psi \mathrm{ d}x = 0 
        &amp;\qquad\forall \psi \in \mathbb{P},\\
\end{aligned}\]</p><p>where <span>$\mathbb{V} = H^{1}_0(\Omega,\mathbb{R}^d)$</span> and <span>$\mathbb{P} = \{p \in L^2(\Omega): \int_\Omega p(x) \mathrm{ d}x = 0\}$</span> denote the velocity and pressure space respectively.</p><p>The discretized system becomes then a symmetric saddle point system, where <span>$L$</span> is the classical discretization of a vector-valued Laplace operator, <span>$B$</span> a type of gradient operator and then its transpose <span>$B^\intercal$</span> corresponding to a divergence operator on the relevant discretized spaces. </p><p class="math-container">\[\begin{aligned}
    S = \begin{pmatrix}
        L &amp; B\\
        B^{\intercal} &amp; -\alpha C
    \end{pmatrix}
\end{aligned}\]</p><p>MinFEM only uses first-order finite elements, which are known for saddle point problems to not fulfill the inf-sup-condition and are thus not naturally pressure stable. A common technique to circumvent this issue would be to use second-order finite elements for the velocity. The combination is then called Taylor-Hood elements and archive stability. Unfortunately, we are not able to do this with MinFEM. However, there are also stabilization techniques for-first order elements available. We will use a version of [1] corresponding to a scaled negative Laplacian. In particular, <span>$C$</span> is a discretization of the Laplacian, where the nodal contributions of each element <span>$T_k$</span> are scaled by <span>$\frac{\operatorname{vol}(T_k)}{\sqrt{d}}$</span> and is thus mesh dependent.       Further, we usually just fix <span>$\alpha = 0.05$</span> as reasonable.</p><p>[1] T. J. Hughes, L. P. Franca, and M. Balestra. <em>A new finite element formulation for computational fluid dynamics: V. Circumventing the babuška-brezzi condition: a stable Petrov-Galerkin formulation of the stokes problem accommodating equal-order interpolations</em>.  In: Computer Methods in Applied Mechanics and Engineering 59.1 (1986), pp. 85–99. doi: <a href="https://doi.org/10.1016/0045-7825(86)90025-3">10.1016/0045-7825(86)90025-3</a>.</p><h2 id="2D-Computations"><a class="docs-heading-anchor" href="#2D-Computations">2D Computations</a><a id="2D-Computations-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Computations" title="Permalink"></a></h2><p>We can now take a look at some example computations. The corresponding scripts can all be found in the <code>examples/</code> directory of the GitHub repository and are all relatively similar. Thus, we will go through the code for the first example and later show only the visualizations with Paraview.</p><h3 id="Channel"><a class="docs-heading-anchor" href="#Channel">Channel</a><a id="Channel-1"></a><a class="docs-heading-anchor-permalink" href="#Channel" title="Permalink"></a></h3><p>As a basic test case, we would like to consider the flow through a straight channel described by the following domain:</p><p class="math-container">\[\begin{aligned}
    \Omega &amp;= (-7,7) \times (-3,3),\\
    \Gamma_{\text{in}} &amp;= \{-7\} \times (-3,3),\\
    \Gamma_{\text{wall}} &amp;=  (-7,7) \times \{-3, 3\}.
\end{aligned}\]</p><p>We have an inflow on the left side, that is described by</p><p class="math-container">\[\bar{v} = \begin{pmatrix}
    \cos\left(\frac{\pi}{6}|x_2|\right)\\
    0
\end{pmatrix}.\]</p><p>In the code, we first have to load the package and <code>MinFEM</code> as the base to handle the domain configuration.</p><pre><code class="language-julia hljs">using MinFEM, MinFEMFlow</code></pre><p>Then we can load the given mesh of the domain and specify the boundary regions. Import a mesh created via <code>gmsh</code> and specify boundary regions by the following commands. Note that in these examples, the <code>4</code> in the mesh name refers to the number of refinements by splitting performed during the mesh creation in <code>gmsh</code>. There are also other meshes and refinement levels available in the <code>meshes/</code> directory. </p><pre><code class="language-julia hljs">mesh::Mesh = import_mesh(&quot;meshes/channel-4.msh&quot;);
noslip_boundary = select_boundaries(mesh, 1001, 1003)
inflow_boundary = select_boundaries(mesh, 1004)</code></pre><p>The inflow function is set up by</p><pre><code class="language-julia hljs">inflow(x) = [cos(pi*abs(x[2])/6), 0.0]</code></pre><p>With this information, we can create a <code>FlowSolver</code> object that contains the solution function for the Stokes flow.</p><pre><code class="language-julia hljs">flow = StokesFlowSolver(mesh, inflow_boundary, noslip_boundary, inflow)</code></pre><p>It remains to actually solve the flow, which will store the solution vector and the computation time in the <code>FlowSolver</code> object. One can then export the solution as a <code>.vtu</code> and visualize it with, e.g., Paraview.</p><pre><code class="language-julia hljs">solve!(flow)
write_to_vtk(flow, &quot;results/channel&quot;)</code></pre><p>Note that we assume the directory <code>results/</code> to exists. Otherwise, the write command will throw an error. If you want to check during runtime if the directory exists and create it if not, you could add <code>mkpath(&quot;results&quot;)</code> before. </p><p>Below, you can see an exemplary visualization using the wireframe of the mesh for the velocity and a surface representation for the corresponding pressure.</p><p><img src="../assets/examples/channel-wireframe.png" alt="Channel Flow Velocity Wireframe"/></p><p><img src="../assets/examples/channel-pressure.png" alt="Channel Flow Pressure"/></p><h3 id="Cylindrical-Obstacle"><a class="docs-heading-anchor" href="#Cylindrical-Obstacle">Cylindrical Obstacle</a><a id="Cylindrical-Obstacle-1"></a><a class="docs-heading-anchor-permalink" href="#Cylindrical-Obstacle" title="Permalink"></a></h3><p>We can make the previous example slightly more interesting by adding an obstacle to the channel. This is something that is commonly used for test cases in flow solvers and shape optimization routines. The domain is then described as</p><p class="math-container">\[\begin{aligned}
    \Omega &amp;= [(-7,7) \times (-3,3)] \setminus \{x \in \mathbb{R}^2: \Vert x \Vert_2 \leq 0.5\}, \\
    \Gamma_{\text{in}} &amp;= \{-7\} \times (-3,3), \\
    \Gamma_{\text{wall}} &amp;=  (-7,7) \times \{-3, 3\},\\
    \Gamma_{\text{obs}} &amp;= \{x \in \mathbb{R}^2: \Vert x \Vert_2 = 0.5\}.
\end{aligned}\]</p><p>The inflow remains unchanged, and the only difference in the code is that the new boundary of the obstacle <code>1005</code> has to be added to the no-slip boundary.</p><p>A visualization could then look like the following. We observe that the maximal magnitude is now larger than 1, which would correspond to the maximum of the inflow, as in the previous example. This is a consequence of the overall narrower channel next to the obstacle. Figuratively speaking, this is what we expect. Since the same amount of fluid has to be transported through a smaller area, it has to flow faster. </p><p><img src="../assets/examples/cylinder-obstacle.png" alt="Channel Flow with Cylindrical Obstacle"/></p><h3 id="L-Channel"><a class="docs-heading-anchor" href="#L-Channel">L Channel</a><a id="L-Channel-1"></a><a class="docs-heading-anchor-permalink" href="#L-Channel" title="Permalink"></a></h3><p>Now, we can start with some just visual examples of various channel flows with slightly more complicated geometry. A mathematical description of the boundaries is not very useful here, if you are interested in the coordinates for specifying the inflow function or physical boundary IDs, you can open the mesh or the corresponding <code>.geo</code>-file in <code>gmsh</code>. Activate the labels via <code>Tools -&gt; Options -&gt; Geometry -&gt; Visibility</code> and make the coordinate grid visible via <code>Tools -&gt; Options -&gt; General -&gt; Axes</code>.</p><p>Here, the long sides of the channel are the no-slip boundaries and the inflow is prescribed on the left boundary by</p><p class="math-container">\[\bar{v} = \begin{pmatrix}
    \cos\left(\frac{\pi}{2}|x_2 - 1|\right)\\
    0
\end{pmatrix}.\]</p><p>As mentioned before, there are lots of different styles to visualize the solution. For the following image, we used the featured edges and a uniform distribution of glyphs at data points. The orientation describes the direction of the flow velocity as well as length and coloring the speed (or magnitude).</p><p><img src="../assets/examples/l-channel-glyph.png" alt="L Channel Flow"/></p><h3 id="U-Channel"><a class="docs-heading-anchor" href="#U-Channel">U Channel</a><a id="U-Channel-1"></a><a class="docs-heading-anchor-permalink" href="#U-Channel" title="Permalink"></a></h3><p>This is example is quite similar to the previous one, just doubled and rotated. The outlet is on the right bottom boundary. The inflow is set on the left bottom boundary and given as</p><p class="math-container">\[\bar{v} = \begin{pmatrix}
    0 \\
    \cos\left(\frac{\pi}{2}|x_2 + 3|\right)
\end{pmatrix}.\]</p><p><img src="../assets/examples/u-channel.png" alt="U Channel Flow"/></p><h3 id="Y-Channel"><a class="docs-heading-anchor" href="#Y-Channel">Y Channel</a><a id="Y-Channel-1"></a><a class="docs-heading-anchor-permalink" href="#Y-Channel" title="Permalink"></a></h3><p>Now, we want to make the domain slightly more complicated again. We start with the classical channel, but then split into two curved pipes with different widths. The inflow is again on the left side and (up to width scaling) identical to the previous channels. Note that a node on the tip of the middle of the pipes was prescribed to ensure a sharp corner. </p><p>With the visualization, we can observe that the majority of the flow goes through the wider pipe, resulting in a larger velocity in that section. In contrast, there is almost no flow in the narrower pipe. </p><p><img src="../assets/examples/y-channel.png" alt="Y Channel Flow"/></p><h3 id="Channel-2"><a class="docs-heading-anchor" href="#Channel-2">∞ Channel</a><a class="docs-heading-anchor-permalink" href="#Channel-2" title="Permalink"></a></h3><p>The last two-dimensional example is a stylized infinity sign. The inflow here is the parabola described by</p><p class="math-container">\[\bar{v} = \begin{pmatrix}
     1 - 2 \left(x_2-\frac{3}{2} \right)^2 \\
    0
\end{pmatrix}.\]</p><p>and prescribed on the upper left boundary. This variation is just for showcasing and does not change the large-scale behavior of the flow.  The lower left boundary acts as the outflow and the rest is no-slip boundary.</p><p>As expected, the majority of the flow just takes the shortest path and flows around the left half-circle. Also, the velocity of the flow in the other circle is small, but not zero. Thus, you have varying maximum velocity magnitudes, in particular, where the channel is temporarily wider at the joints.</p><p><img src="../assets/examples/infinity-channel-wireframe.png" alt="Infinity Channel Flow"/></p><h2 id="3D-Computations"><a class="docs-heading-anchor" href="#3D-Computations">3D Computations</a><a id="3D-Computations-1"></a><a class="docs-heading-anchor-permalink" href="#3D-Computations" title="Permalink"></a></h2><p>For completeness, we would like to also state some three-dimensional computations. However, be reminded that the computational complexity grows rapidly in 3D and thus a sequential implementation with a direct linear solver is usually not suitable for relevant problems. The results here are computed on coarse grids, which still contain artifacts from the mesh, but give a general idea for the flow behavior. The provided example files and meshes provided here run in a few minutes. However, on the next refinement level, e.g., as shown in the visualization of the <a href="../">home</a> page of this documentation, can run for more than a day or even exceed the memory.</p><h3 id="Channel-3"><a class="docs-heading-anchor" href="#Channel-3">Channel</a><a class="docs-heading-anchor-permalink" href="#Channel-3" title="Permalink"></a></h3><p>The code for this three-dimensional example is similar to the two-dimensional setting. Just be aware that the boundary elements are now surfaces and not lines anymore. In the following code snippet, this is indicated by having an additional zero in the identifiers. Also, the no-slip walls now contain 4 planes instead of 2 edges.</p><pre><code class="language-julia hljs">mesh::Mesh = import_mesh(&quot;meshes/3D-channel-1.msh&quot;)
noslip_boundary = select_boundaries(mesh, 10001, 10002, 10003, 10005)
inflow_boundary = select_boundaries(mesh, 10006)</code></pre><p>The inflow function is adjusted by taking the product of the two-dimensional inflow for each component of the inflow surface. This results in a single cosine bump, fulfilling compatibility with the zero velocity at the walls from the no-slip condition. </p><p class="math-container">\[\bar{v} = \begin{pmatrix}
    \cos\left(\frac{\pi}{6}|x_2|\right)\,\cos\left(\frac{\pi}{6}|x_3|\right)\\
    0 \\
    0
\end{pmatrix}.\]</p><p>Visualization also works similar, but usually it is more involved to create meaningful images. Thus, we chose to represent the full box by a wireframe and also use a diagonal clip to show the flow in the interior. With the standard surface plot, you would not see the interior behavior, but only a box with the inlet, the outlet and 4 dark blue sides representing the zero velocity at the no-slip condition.</p><p><img src="../assets/examples/3D-channel.png" alt="3D Channel Flow Cut"/></p><h3 id="Cubical-Obstacle"><a class="docs-heading-anchor" href="#Cubical-Obstacle">Cubical Obstacle</a><a id="Cubical-Obstacle-1"></a><a class="docs-heading-anchor-permalink" href="#Cubical-Obstacle" title="Permalink"></a></h3><p>Similar to the two-dimensional examples, the problem becomes more interesting when adding an obstacle to the domain. Therefore, we added a cube with the identifier <code>10007</code> to the middle of the channel. This obstacle is slightly more involved than a ball due to the sharp corners and edges. In the visualization below, we can observe that the flow behavior in the interior resembles what we expect from the cylindrical obstacle. However, around the cube we can also see some artifacts indicating that we would require a higher mesh resolution for this problem.</p><p><img src="../assets/examples/cube-obstacle.png" alt="3D Channel Flow Cut with Cubical Obstacle"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../library/">Library »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 10 January 2025 21:58">Friday 10 January 2025</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
